<app-section-container>
  <div class="part">
    <h2>
      <span class="cli-header">CLI header (always {{pe.cliHeaderSize}} bytes)</span>
    </h2>
    <p>From
      <span class="mono-font">{{pe.cliHeader.startOffsetDec | byte | leftpad:8}}</span> to
      <span class="mono-font">{{pe.cliHeader.endOffsetDec | byte | leftpad:8}}</span>
    </p>
    <p>
        The CLI metadata header (8 bytes) is located at offset {{peConstants.cliMetadataHeaderDirectorySubOffsetDec}} of the
        <span class="cli-header">CLI header</span>. It points to a header of
        <span class="cli-header cli-metadata-header-directory-size mono-font">{{pe.cliMetadataHeaderDirectory.size.hexValue | hex}}</span>
        bytes located at base RVA
        <span class="cli-header cli-metadata-header-directory-rva mono-font">{{pe.cliMetadataHeaderDirectory.rva.rva | hex}}</span>.
        We can compute the file offset using this formula:
    </p>
    <ul>
      <li>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cli-header cli-metadata-header-directory-rva mono-font">{{pe.cliMetadataHeaderDirectory.rva.rva | hex}}</span>
        (CLI metadata header base RVA)
      </li>
      <li>
        <span class="mono-font">-</span>&nbsp;<span class="data-directories cli-header-directory-rva mono-font">{{pe.textSectionItem.baseRva.rva | hex}}</span>
        (.text section base RVA)
      </li>
      <li>
        <span class="mono-font">+</span>&nbsp;<span class="text-section-header text-file-offset mono-font">{{pe.textSectionItem.fileOffset.fileOffset | hex}}</span>
        (.text section file offset)
      </li>
      <li>
        <span class="mono-font">=</span>&nbsp;<span class="mono-font">{{pe.cliMetadataHeader.startOffsetDec | byte | leftpad:8}}</span>
      </li>
    </ul>
    <p>The <span class="cli-header cli-flags">CLI flags</span> ({{peConstants.cliFlagsSizeDec}} bytes) are located at offset
      {{peConstants.cliFlagsSubOffsetDec}} of the <span class="cli-header">CLI header</span> and have a value of
      <span class="mono-font cli-header cli-flags">{{pe.cliFlags.hexValue | hex}}</span>. The <span class="cli-header cli-flags">CLI flags</span>
      are leveraging <app-link [href]="'https://en.wikipedia.org/wiki/Mask_(computing)'">bitmask</app-link>:
    </p>
    <ul>
      <li><span class="mono-font">ILOnly&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x00001</span>: <em>{{pe.cliFlags.ILOnly}}</em>
        ({{pe.cliFlags.ILOnly ? 'contains only managed code' : 'contains managed and native code'}})
      </li>
      <li><span class="mono-font">Requires32Bit&nbsp;&nbsp;&nbsp; 0x00002</span>: <em>{{pe.cliFlags.Requires32Bit}}</em>
        (<app-link [href]="'http://blogs.microsoft.co.il/sasha/2012/04/04/what-anycpu-really-means-as-of-net-45-and-visual-studio-11/'">requires</app-link>
        32-bit when compiled in AnyCPU)</li>
      <li><span class="mono-font">ILLibrary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x00004</span>: <em>{{pe.cliFlags.ILLibrary}}</em></li>
      <li><span class="mono-font">StrongNameSigned 0x00008</span>: <em>{{pe.cliFlags.StrongNameSigned}}</em>
        (see <app-link [href]="'https://docs.microsoft.com/en-us/dotnet/framework/app-domains/strong-named-assemblies'">strong named</app-link>)
      </li>
      <li><span class="mono-font">NativeEntryPoint 0x00010</span>: <em>{{pe.cliFlags.NativeEntryPoint}}</em></li>
      <li><span class="mono-font">TrackDebugData&nbsp;&nbsp; 0x10000</span>: <em>{{pe.cliFlags.TrackDebugData}}</em></li>
      <li><span class="mono-font">Prefers32Bit&nbsp;&nbsp;&nbsp;&nbsp; 0x20000</span>: <em>{{pe.cliFlags.Prefers32Bit}}</em>
        (<app-link [href]="'http://blogs.microsoft.co.il/sasha/2012/04/04/what-anycpu-really-means-as-of-net-45-and-visual-studio-11/'">prefers</app-link>
        32-bit when compiled in AnyCPU)</li>
    </ul>
  </div>
</app-section-container>
<app-section-container>
  <div class="part">
    <h2>
      <span class="cli-metadata-header">CLI metadata header ({{pe.cliMetadataHeader.sizeDec}} bytes)</span>
    </h2>
    <p>From
      <span class="mono-font">{{pe.cliMetadataHeader.startOffsetDec | byte | leftpad:8}}</span> to
      <span class="mono-font">{{pe.cliMetadataHeader.endOffsetDec | byte | leftpad:8}}</span>
    </p>
    <p>The <span class="cli-metadata-header clr-version-size">CLR version size</span> ({{peConstants.clrVersionSizeSizeDec}} bytes) is located at offset
      {{peConstants.clrVersionSizeSubOffsetDec}} of the <span class="cli-metadata-header">CLI metadata header</span> and has a value of
      <span class="mono-font cli-metadata-header clr-version-size">{{pe.clrVersionSize.hexValue | hex}} bytes</span>. The targeted
      <span class="cli-metadata-header clr-version">CLR version</span> is encoded using <em>ASCII</em> characters and has for value
      <span class="mono-font cli-metadata-header clr-version">{{pe.clrVersion.text}}</span>.
    </p>
  </div>
</app-section-container>
